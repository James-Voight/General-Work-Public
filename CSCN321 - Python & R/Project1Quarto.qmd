---
title: "EDA & Visualization Assignment"
author: "James Voight"
date: "09-22-2024"
date-format: long
format:
  #pdf
  #pptx
  #docx:
    #reference-doc: knowles-custom-reference-doc.docx # make sure it is in the same folder as the .qmd
      # Run this in your python terminal to create a basic reference-doc that you can modify:
      # quarto pandoc -o custom-reference-doc.docx --print-default-data-file reference.docx
  html: # or docx for Word Document
    toc: true # includes table of contents
    code-fold: true # option for collapsing code blocks in html
execute:
  echo: true # includes output
  warning: false # turns off warnings
  error: false # if set to true, then stops running at error
  output: true
python:
  version: "3.12.4"  # Specify your Python version here
  
---

# R Code
```{r}
#installations
# install.packages("GGally")
# install.packages("ggplot2")
# install.packages("corrplot")
```

# Python Code
```{python}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```

## Q1a - Python
```{python}
approvals = pd.read_csv('C:/Users/james/Downloads/credit_card_approvals.csv')
print(approvals.dtypes)  # To check data types
```

## Q1a - R
```{r}
# 1
approvals <- read.csv('C:/Users/james/Downloads/credit_card_approvals.csv')
print(str(approvals))
``` 

## Q2a - Python
```{python}
# 2
print(approvals.shape)
print(approvals.isnull().sum())
```

## Q2a - R
```{r}
# 2
print(dim(approvals)) # gave 690 rows and 16 columns
print(any(is.na(approvals))) #gives false, no missing data
``` 

## Q3a - Python
```{python}
# 3
print(approvals.describe())
```

## Q3a - R
```{r}
#3
print(summary(approvals))
``` 

## Q4a - Python
```{python}
# 4
plt.hist(approvals['Age'], bins=10)
plt.title('Age Histogram')
plt.show()

sns.kdeplot(approvals['Age'])
plt.title('Age Density')
plt.show()
```

## Q4a - R
```{r}
#4
library(ggplot2)

print(ggplot(approvals, aes(x = Age)) + geom_histogram(bins = 10) + ggtitle("Age Histogram"))
    # bin width of 10 to get a general look at the skew

print(ggplot(approvals, aes(x = Age)) + geom_density() + ggtitle("Age Density"))
    #the median has almost almost half of the values
``` 

## Q5a - Python
```{python}
# 5
plt.hist(approvals['Debt'], bins=10, density=True, alpha=0.5)
sns.kdeplot(approvals['Debt'])
plt.axvline(approvals['Debt'].mean(), color='r', linestyle='dotted')
plt.title('Debt Histogram and Density')
plt.show()
```

## Q5a - R
```{r}
#5
print(ggplot(approvals, aes(x=Debt)) + 
  geom_histogram(aes(y=..density..), bins=10, alpha=0.5) + 
  geom_density() + 
  geom_vline(aes(xintercept=mean(Debt)), linetype="dotted") + 
  ggtitle("Debt Histogram and Density"))
    #skewed right, higher density at about 70000 compared to 50000
``` 

## Q6a - Python
```{python}
# 6
sns.regplot(x='Debt', y='Income', data=approvals)
plt.title('Debt vs Income')
plt.show()
```

## Q6a - R
```{r}
#6
print(ggplot(approvals, aes(x=Debt, y=Income)) + 
  geom_point() + 
  geom_smooth(method='lm') + 
  ggtitle("Debt vs Income"))

    # limit y-axis if want to see closer
print(ggplot(approvals, aes(x=Debt, y=Income)) + 
  geom_point() + 
  geom_smooth(method='lm') + 
  ylim(0, 150000) +  # Set y-axis limit to [0, 200,000]
  ggtitle("Debt vs Income"))
  # shows that most people have less debt than their income and most have less than 100000 in debt or income
``` 

## Q7a - Python
```{python}
# 7
approvals.groupby(['Ethnicity', 'Industry']).size().unstack().plot(kind='barh', stacked=True)
plt.title('Industry by Ethnicity')
plt.show()
```

## Q7a - R
```{r}
#7
print(ggplot(approvals, aes(x=Industry, fill=Ethnicity)) + 
  geom_bar() + 
  coord_flip() + 
  ggtitle("Industry by Ethnicity"))
  #White ethnicity have the majority of jobs in everything but transport, research, and healthcare. Healthcare is almost purely latino. The most people work in energy and the least in transport
``` 

## Q8a - Python
```{python}
# 8

approval_counts = approvals.groupby(['Ethnicity', 'Approved']).size().unstack(fill_value=0)

    # Stacked Bar Plot
approval_counts.plot(kind='barh', stacked=True, color=['lightblue', 'salmon'], legend=True)
plt.title('Stacked Bar Plot: Approvals and Disapprovals by Ethnicity')
plt.xlabel('Number of Applicants')
plt.ylabel('Ethnicity')
plt.legend(title='Approval Status', labels=['Disapproved', 'Approved'])
plt.tight_layout()
plt.show()

# Unstacked Bar Plot
approval_counts.plot(kind='barh', color=['lightblue', 'salmon'], legend=True)
plt.title('Unstacked Bar Plot: Approvals and Disapprovals by Ethnicity')
plt.xlabel('Number of Applicants')
plt.ylabel('Ethnicity')
plt.legend(title='Approval Status', labels=['Disapproved', 'Approved'])
plt.tight_layout()
plt.show()
```

## Q8a - R
```{r}
# 8
print(ggplot(approvals, aes(x=Ethnicity, fill=factor(Approved))) + 
  geom_bar(position="stack") + 
  coord_flip() + 
  ggtitle("Approvals by Ethnicity"))

print(ggplot(approvals, aes(x=Ethnicity, fill=factor(Approved))) + 
  geom_bar(position = "dodge") + 
  coord_flip() + 
  ggtitle("Approvals by Ethnicity"))
  #you can see that even though white has the most approvals, they also have a greater number of rejections. latinos have the smallest percentage of approvals and black the highest
``` 

## Q9a - Python
```{python}
# 9
sns.boxplot(x='Industry', y='Debt', data=approvals)
plt.xticks(rotation=45, ha='right')
plt.title('Debt by Industry')
plt.savefig('debt_industry.png')
plt.show()
```

## Q9a - R
```{r}
# 9
print(ggplot(approvals, aes(x=Industry, y=Debt)) + geom_boxplot() + ggtitle("Debt by Industry") + theme(axis.text.x = element_text(angle = 45, hjust = 1)))
ggsave("debt_industry.png")
    #Education has the highest range of debt and research the lowest range.  healthcare is a close second highest but still maintains a low median. energy has the worst outliers
``` 

## Q10a - Python
```{python}
# 10
sns.boxplot(x='Industry', y='YearsEmployed', data=approvals)
plt.xticks(rotation=45, ha='right')
plt.title('Years Employed by Industry')
plt.savefig('employed_industry.png')
plt.show()
```

## Q10a - R
```{r}
print(ggplot(approvals, aes(x=Industry, y=YearsEmployed)) + geom_boxplot() + ggtitle("Years Employed by Industry") + theme(axis.text.x = element_text(angle = 45, hjust = 1)))
ggsave("employed_industry.png")
    #research has the lowest years employeed by far meanwhile trasnport has the highest median. energy has many outliers that have worked there for a long time.
``` 

## Q11a - Python
```{python}
# 11
    #heatmap
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd

selected_columns = ['Age', 'Debt', 'Income', 'CreditScore', 'YearsEmployed']
approvals_selected = approvals[selected_columns]

# Calculate the correlation matrix
correlation_matrix = approvals_selected.corr()

# Plot the heatmap
plt.figure(figsize=(10, 6))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', vmin=-1, vmax=1)
plt.title('Correlation Heatmap of Selected Variables')
plt.tight_layout()
plt.show()



#pairplot

sns.pairplot(approvals_selected)
plt.title('Pairplot of Selected Variables')
plt.show()

# help with pairplot (Rustagi, 2022)
```

## Q11a - R
```{r}
# 11
    #heatmap
library(ggplot2)
library(corrplot)
library(GGally)

    # Select relevant numerical features
approvals_selected <- approvals[, c('Age', 'Debt', 'Income', 'CreditScore', 'YearsEmployed')]

    # Calculate the correlation matrix
correlation_matrix <- cor(approvals_selected)

    # Plot the heatmap
print(corrplot(correlation_matrix, method = "color", col = colorRampPalette(c("blue", "white","red"))(200), tl.cex = 0.8, tl.col = "black", addCoef.col = "black", number.cex = 0.7))
title('Correlation Heatmap of Selected Variables')

    #this heatmap lets us see the correlation between each variable used. for example, age and yearsemployeed have a higher correlation. we can also see that age and income are hardly related.



    # Plot pairplot of selected columns
print(ggpairs(approvals_selected) + ggtitle("Pairplot of Selected Variables"))
    # a pair plot can be useful for understanding trends andclusters in the data. uses a scatterplot and a density graph(r) or bar graph(py)

    #help with pairplot (Schloerke, 2021)
``` 
# Interpretation of the Data Analysis: Credit Card Approvals

## Q3
From the summary descriptive statistics we can tell that most of the data is skewed to the right since the mean is larger than the median. Examples of this include age, debt, years employed, employeed, creditscore, driverslicense, zipcode, income, and approved. Most of the data provided also has outliers such as 400000 for income meaning that they may cause trouble in later graphs.

## Q4
For the barplot, a bin width of 10 was used to get a general look at the skew/positioning of the data. The density graph shows that the median has almost half of the values in the data set near it, showing how many people are in that section.

## Q5
After ploting the histogram and density of debt on the same graph, we can tell that the data is skewed to the right from the mean being greater than the median again. There is also a slight uptick in density at about 70000 compared to 50000.

## Q6
In this scatterplot, we come into a problem of the outlier being so high that we have trouble reading the data. This can be solved by either getting rid of the value or simply limiting the height on the y-axis. The graph shows that most people have less debt than their income and that most have also less than 100000 in debt and/or income.

## Q7
This bar graph of Industry by Ethnicity shows that the white ethnicity has a majority of jobs in everything but transport, research, and healthcare. Meanwhile, healthcare is almost purely latino. Combining all the ethnicities, most people work in energy and the least amount of people in work in transport.

## Q8
This horizontal bar graph of approvals by ethnicity shows that even though the white ethnicity has the most approvals, they also have a greater number of rejections. We can also see that latinos have the smallest percentage of approvals and black have the highest percentage. Separating the approvals and rejections to being placed alongside each other allows us to more accurately compare the data values.

## Q9
After creating the debt by industry boxplot we can see that education has the highest range of debt and research has the lowest range. We can also see that healthcare is the second highest but still maintains a low median value of debt. The energy division has the worst and largest outliers.

## Q10
In this boxplot of years employed by industry we can interpret that research has the lowest years employed by far. Meanwhile, trasnport has the highest median. Energy has many outliers again meaning several workers have worked there for a much longer time than some other staff.

## Q11
I chose a heatmap and a pairplot for my two graphs. The heatmap lets us see the correlation between each variable used. For example, age and yearseemployed have a high correlation between them. We can also see that age and income are hardly related at all. The pairplot can be useful for understanding/finding trends and clusters in the data. It uses a scatterplot and a density graph in r, but when I made one in python it used a scatterplot and a bar graph.

## Summary & Reflection 

### Review
I do believe after reviewing all the information gathered that there is a lot of important data that the company should know. An example of this is that age only has about a 0.19 correlation with their credit score. Thus, it wouldn't make sense to have any younger or older generations to be more likely to get approved for credit. There is however a 0.2 correlation between age and debt. The younger ages are more likely to go into debt unfortunately. The company should also know about the extreme outliers. For example, the person with an income of 400000 might be someone that the company should make note of and treat well. That in comparison to almost half of the citizens being tested were in fact unemployed.

### Ethical Implications
The inclusion of this data can have multiple ethical implications. One example is discrimination among people based on their data. The company may not trust workers as much if they find out that they haven't held a job for a long time. Those in debt and with bad credit may find themselves in a worse financial situation since they will be limited by their services. THat will not be able to take out loans to start small businesses, invest in their education, or even buy homes. This will lead to a long-term economic disadvantage for their life.

### Biblical Worldview
As a Christian, scripture warns us that we should not be biased in our decision making. In Proverbs 31:9, we are called to speak up for those in need and to defend their rights by judging them fairly. When we use these models to deny people of credit that they might desparately need, we are obligated to make sure that there is no bias or discrimination by factors such as gender or age (Hendrickson Publishers 2004).

{{< pagebreak >}}

# References

###### Hendrickson Publishers. (2004). The holy Bible: King James Version.

###### Rustagi, D. (2022, November 11). Python - seaborn.pairplot() method. GeeksforGeeks. https://www.geeksforgeeks.org/python-seaborn-pairplot-method/

###### Schloerke, B. (2021, December 5). Pairs plot in ggplot2 with ggpairs. R CHARTS. https://r-charts.com/correlation/ggpairs/